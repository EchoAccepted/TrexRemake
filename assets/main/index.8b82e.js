window.__require=function t(i,o,e){function n(s,a){if(!o[s]){if(!i[s]){var u=s.split("/");if(u=u[u.length-1],!i[u]){var c="function"==typeof __require&&__require;if(!a&&c)return c(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+s+"'")}s=u}var p=o[s]={exports:{}};i[s][0].call(p.exports,function(t){return n(i[s][1][t]||t)},p,p.exports,t,i,o,e)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<e.length;s++)n(e[s]);return n}({MainController:[function(t,i,o){"use strict";cc._RF.push(i,"1ef82iwv1hIQpjR5SBIHTuB","MainController");var e,n=this&&this.__extends||(e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(t,i)},function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}),r=this&&this.__decorate||function(t,i,o,e){var n,r=arguments.length,s=r<3?i:null===e?e=Object.getOwnPropertyDescriptor(i,o):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,i,o,e);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(i,o,s):n(i,o))||s);return r>3&&s&&Object.defineProperty(i,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,u=s.property,c=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.plantsArray=new Array,i.grounds=new Array,i.clouds=new Array,i.currentNode=null,i.historyNum=null,i.jumpAudio=null,i.scoreAudio=null,i.hitAudio=null,i.resetBtn=null,i.jumpHeight=150,i.cloudSpeed=2,i.roadSpeed=5,i.playStatus=!1,i.lifeStatus=!0,i.historyRecord=0,i.JumpAnimate=null,i.moveAction=null,i.valid=!0,i.animState=null,i.animatedTime=null,i.score=0,i.blinkVaild=!0,i.initial=!0,i}return n(i,t),i.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.throttle,this),this.instiatePrefab(this.grounds[1]),this.resetBtn.node.on("click",this.restart,this)},i.prototype.start=function(){cc.director.getCollisionManager().enabled=!0;this.moveAction=new function(t){var i=this;this.trexStart=function(){return i.animateComponent.play("Move")},this.trexJump=function(){return i.animateComponent.play("Jump")},this.trexDie=function(){return i.animateComponent.play("Dead")},this.trexPause=function(){return i.animateComponent.pause()},this.trexStop=function(){return i.animateComponent.stop()},this.animateComponent=t}(this.node.getComponent(cc.Animation))},i.prototype.throttle=function(t){this.valid&&(this.valid=!1,this.onKeyDown(t))},i.prototype.onKeyDown=function(t){if(t.keyCode===cc.macro.KEY.space)if(!this.playStatus&&this.lifeStatus)this.playStatus=!0,this.moveAction.trexStart(),this.currentNode.getComponent(cc.Animation).play(),this.jumpAction();else if(this.playStatus&&this.lifeStatus)this.jumpAction();else{if(this.playStatus&&!this.lifeStatus)return;this.playStatus||this.lifeStatus||this.restart()}},i.prototype.jumpAction=function(){this.moveAction.trexJump(),this.jumpAnimate()},i.prototype.jumpAnimate=function(){var t=this;this.JumpAnimate=cc.tween(this.node).by(.3,{position:cc.v3(0,this.jumpHeight,0)},{easing:"quadOut"}).by(.3,{position:cc.v3(0,-this.jumpHeight,0)},{easing:"quadIn"}).call(function(){t.valid=!0,t.moveAction.trexStart()}).start()},i.prototype.jumpAnimateStop=function(){this.JumpAnimate.stop()},i.prototype.instiatePrefab=function(t){t.children.length>0&&t.removeAllChildren();for(var i=Math.floor(3*Math.random())+3,o=0;o<i;o++){var e=Math.floor(this.initial?4*Math.random():6*Math.random()),n=cc.instantiate(this.plantsArray[e]);n.parent=t||this.grounds[0],n.setPosition(-(2400/i*(o+1)+100*Math.random()*(Math.random()>=.5?-1:1)),0)}this.initial=!1},i.prototype.onCollisionEnter=function(){var t=this;this.jumpAnimateStop(),this.moveAction.trexStop(),this.moveAction.trexDie(),this.playStatus=!1,this.lifeStatus=!1;var i=this.currentNode.getComponent(cc.Animation);if(i.pause(),this.animState=i.getAnimationState("Main"),this.animatedTime=this.animState.time,this.resetBtn.node.y=-100,this.animatedTime>this.historyRecord){this.historyRecord=this.animatedTime,this.historyNum.y=95;var o=this.historyNum.children[1].getComponent(cc.Animation);o.play("Main",this.historyRecord),o.pause(),o.setCurrentTime(this.historyRecord)}var e=setTimeout(function(){t.valid=!0,clearTimeout(e)},300)},i.prototype.restart=function(){this.valid=!0,this.playStatus=!0,this.lifeStatus=!0,this.grounds[0].removeAllChildren(),this.grounds[1].removeAllChildren(),this.currentNode.getComponent(cc.Animation).play(),this.resetBtn.node.y=-500,this.node.y=-270,this.moveAction.trexStart(),this.initial=!0},i.prototype.update=function(){this.playStatus&&this.lifeStatus&&(this.clouds[0].x-=this.cloudSpeed,this.clouds[1].x-=this.cloudSpeed,this.grounds[0].x-=this.roadSpeed,this.grounds[1].x-=this.roadSpeed,this.grounds[0].x<=-480&&(this.grounds[0].setPosition(this.grounds[0].x+4800,this.grounds[0].y),this.instiatePrefab(this.grounds[0])),this.grounds[1].x<=-480&&(this.grounds[1].setPosition(this.grounds[1].x+4800,this.grounds[0].y),this.instiatePrefab(this.grounds[1])),this.clouds[0].x<=-600&&this.clouds[0].setPosition(this.clouds[0].x+1150,this.clouds[0].y),this.clouds[1].x<=-680&&this.clouds[1].setPosition(this.clouds[1].x+1200,this.clouds[1].y))},r([u([cc.Prefab])],i.prototype,"plantsArray",void 0),r([u([cc.Node])],i.prototype,"grounds",void 0),r([u([cc.Node])],i.prototype,"clouds",void 0),r([u(cc.Node)],i.prototype,"currentNode",void 0),r([u(cc.Node)],i.prototype,"historyNum",void 0),r([u(cc.AudioClip)],i.prototype,"jumpAudio",void 0),r([u(cc.AudioClip)],i.prototype,"scoreAudio",void 0),r([u(cc.AudioClip)],i.prototype,"hitAudio",void 0),r([u(cc.Button)],i.prototype,"resetBtn",void 0),r([u],i.prototype,"jumpHeight",void 0),r([u],i.prototype,"cloudSpeed",void 0),r([u],i.prototype,"roadSpeed",void 0),r([a],i)}(cc.Component);o.default=c,cc._RF.pop()},{}]},{},["MainController"]);